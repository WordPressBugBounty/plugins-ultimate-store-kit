!function(t){"use strict";function a(a){a.find('*[data-filter="yes"]').each((function(){const a=t(this);t(".tab-option").off("click").on("click",(function(){const a=t(this).data("grid-column");var n;localStorage.setItem("usk_grid_data",a),(n=t(this)).closest(".usk-grid-header").find("li").removeClass("usk-tabs-active"),n.parent().addClass("usk-tabs-active"),function(t,a){const n=t.closest(".usk-grid-header").parent().find(".usk-grid"),e="usk-list-2"!==a?"usk-grid usk-grid-layout":"usk-grid usk-list-layout";n.removeClass().addClass(e+" "+a)}(t(this),a)})),function(a){const n=localStorage.getItem("usk_grid_data");if(n){const e=t("[data-grid-column='"+n+"']");if(e.length){e.parent().addClass("usk-tabs-active");const t="usk-list-2"!==n?"usk-grid usk-grid-layout":"usk-grid usk-list-layout";a.find(".usk-grid").removeClass().addClass(t+" "+n)}}}(a)}))}function n(a){a.find(".usk-variation-button").off("click").on("click",(function(a){a.preventDefault();const n=t(this),i=n.data("product-id"),s=n.data("attribute"),r=n.data("value"),d=n.data("variation-id"),c=t(`.usk-item[data-product-id="${i}"]`);if(n.hasClass("active")){if(c.find(".usk-variation-button.active").length>1){n.removeClass("active");const a=e(c);return void(Object.keys(a).length>0?o(c,i,null,a):function(a){const n=a.find(".usk-button");if(!n.length)return;t.each(n[0].attributes,(function(){0===this.name.indexOf("data-attribute_")&&n.removeAttr(this.name)})),n.removeClass("add_to_cart_button product_type_variation").addClass("product_type_variable").attr("href","javascript:void(0)").removeAttr("data-variation_id").html('Select options <i class="button-icon usk-icon-arrow-right-8"></i>')}(c))}}!function(a,n,e){t(`.usk-variation-button[data-attribute="${e}"][data-product-id="${n}"]`).removeClass("active"),a.addClass("active")}(n,i,s);const u=e(c);Object.keys(u).length>0&&o(c,i,d,u),"pa_color"===s&&(function(a,n,e){t.ajax({url:woocommerce_params.ajax_url,type:"POST",data:{action:"get_variation_data",product_id:a,variation_id:n},success:function(t){t.success&&t.data?.image?.src&&e.find(".image-default, .image-hover").attr("src",t.data.image.src)}})}(i,d,c),function(t,a,n){const e=t.css("background-color");e&&"transparent"!==e&&"rgba(0, 0, 0, 0)"!==e&&n.attr("data-selected-color",a)}(n,r,c))}))}function e(a){const n={};return a.find(".usk-variation-button.active").each((function(){n[t(this).data("attribute")]=t(this).data("value")})),n}function o(a,n,e,o){const r=a.find(".usk-button");if(!r.length)return;t.each(r[0].attributes,(function(){0===this.name.indexOf("data-attribute_")&&r.removeAttr(this.name)}));let d=e;Object.keys(o).length>1?s(a,o,n).then((t=>{t&&(d=t,i(r,n,d,o))})):i(r,n,d,o)}function i(t,a,n,e){t.attr({"data-variation_id":n,"data-product_id":a,href:"javascript:void(0)"}),Object.keys(e).forEach((a=>{t.attr(`data-attribute_${a}`,e[a])})),t.addClass("add_to_cart_button product_type_variation").removeClass("product_type_variable").html('Add to cart <i class="button-icon usk-icon-arrow-right-8"></i>')}function s(a,n,e){return new Promise((a=>{t.ajax({url:woocommerce_params.ajax_url,type:"POST",data:{action:"usk_find_variation",product_id:e,attributes:n},success:function(t){t.success&&t.data.variation_id?a(t.data.variation_id):a(null)},error:function(){a(null)}})}))}function r(){t(document.body).off("click",".usk-shiny-grid .usk-button.product_type_variation"),t(document.body).on("click",".usk-shiny-grid .usk-button.product_type_variation",(function(a){a.preventDefault();const n=t(this);if(n.hasClass("processing"))return!1;if(n.addClass("processing loading"),!n.data("variation_id")||!n.data("product_id"))return n.removeClass("processing loading"),!0;const o=function(a){const n={product_id:a.data("product_id"),variation_id:a.data("variation_id"),quantity:a.data("quantity")||1,"add-to-cart":a.data("product_id")};return t.each(a[0].attributes,(function(){this.name.startsWith("data-attribute_")&&(n[this.name.substring(5)]=this.value)})),n}(n);return function(a,n){const o={};t.each(a[0].attributes,(function(){if(this.name.startsWith("data-attribute_")){const t=this.name.replace("data-","");o[t]=this.value}}));const r={action:"usk_add_to_cart",nonce:usk_ajax_config.nonce,product_id:n.product_id,variation_id:n.variation_id,quantity:n.quantity||1};Object.assign(r,o),console.log("Sending data:",r),t.ajax({url:usk_ajax_config.ajax_url,type:"POST",data:r,cache:!1,success:function(n){if(console.log("Success response:",n),a.removeClass("loading"),!n||n.error)return console.error("Error response:",n),void a.removeClass("processing");t(document.body).trigger("wc_fragment_refresh"),t(document.body).trigger("added_to_cart");const o=t('<div class="usk-cart-success-message">Product added to cart! âœ“</div>');a.closest(".usk-item").append(o),setTimeout((function(){o.fadeOut(300,(function(){t(this).remove(),a.removeClass("processing"),function(a){const n=a.data("product_id"),o=(a.data("variation_id"),t(`.usk-item[data-product-id="${n}"]`)),r=e(o);Object.keys(r).length>0&&s(0,r,n).then((t=>{t&&i(a,n,t,r)}))}(a)}))}),2e3)},error:function(t,n,e){console.error("AJAX Error:",t.responseText),console.error("Status:",n),console.error("Error:",e),a.removeClass("loading processing")},complete:function(){setTimeout((function(){a.removeClass("loading processing")}),2500)}})}(n,o),!1}))}function d(t){a(t),n(t),r(),t.find(".usk-button.processing").removeClass("processing")}function c(t){d(t)}t(document.body).on("added_to_cart removed_from_cart wc_fragments_refreshed",(function(){setTimeout((function(){t(".usk-button.processing").removeClass("processing"),t(".usk-variations-container").each((function(){const a=t(this).data("product-id"),n=t(`.usk-item[data-product-id="${a}"]`);if(n.length){const t=n.find(".usk-button"),o=e(n);Object.keys(o).length>0&&s(0,o,a).then((n=>{n&&i(t,a,n,o)}))}}))}),500)})),t(document).ajaxComplete((function(a,n){n.responseText&&(n.responseText.indexOf("usk-shiny-grid")>-1||n.responseText.indexOf("usk-variation-button")>-1||n.responseText.indexOf("usk-grid")>-1)&&d(t(document))})),t(window).on("elementor/frontend/init",(function(){elementorFrontend.hooks.addAction("frontend/element_ready/usk-shiny-grid.default",c)})),t(window).on("elementor/frontend/init",(function(){elementorFrontend.hooks.addAction("frontend/element_ready/usk-glossy-grid.default",a)})),t(window).on("elementor/frontend/init",(function(){elementorFrontend.hooks.addAction("frontend/element_ready/usk-florence-grid.default",a)}))}(jQuery,window.elementorFrontend);